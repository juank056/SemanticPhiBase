<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:icecore="http://www.icefaces.org/icefaces/core"
	xmlns:ace="http://www.icefaces.org/icefaces/components"
	xmlns:ice="http://www.icesoft.com/icefaces/component"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:p="http://java.sun.com/jsp/jstl/core">
<ui:composition template="/template/index_template.xhtml">
	<ui:define name="tittle">
	#{msgs.newPassword_update}
	</ui:define>
	<ui:define name="content">
		<h:form id="form">
			<center>
				<table>
					<tr>
						<td><img src="./images/login.jpg" alt="Login" /></td>
						<td>
							<table>
								<tr>
									<td class="caption"><ice:outputText
											value="#{msgs.index_username}" /></td>
									<td><ice:outputText value="#{autenticationBean.userName}" /></td>
								</tr>
								<tr>
									<td class="caption"><ice:outputText
											value="#{msgs.newPassword_currPasswd}" /></td>
									<td><ice:inputSecret styleClass="loginField" id="curP1"
											value="#{newPasswordBean.currentPassword}"
											onkeydown="validateNewPass()"></ice:inputSecret></td>
								</tr>
								<tr>
									<td class="caption"><ice:outputText
											value="#{msgs.newPassword_newPasswd}" /></td>
									<td><ice:inputSecret styleClass="loginField"
											value="#{newPasswordBean.newPassword}" id="newP1"
											onkeyup="validateNewPass()" onkeydown="validateNewPass()" /></td>
								</tr>
								<tr>
									<td class="caption"><ice:outputText
											value="#{msgs.newPassword_newPasswdConf}" /></td>
									<td><ice:inputSecret styleClass="loginField" id="newP2"
											onkeyup="validateNewPass()" onkeydown="validateNewPass()"></ice:inputSecret></td>
								</tr>
								<tr>
									<td colspan="1" align="left"><ice:commandLink
											styleClass="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-left"
											onclick="history.go(-1);">
											<span class="ui-button-text ui-c">#{msgs.cancel}</span>
											<span
												class="ui-button-icon-left ui-icon ui-c ui-icon-circle-close"></span>
										</ice:commandLink></td>
									<td colspan="1" align="right"><ice:commandLink
											styleClass="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-left"
											action="#{newPasswordBean.updatePassword}" type="submit"
											id="changeButton">
											<span class="ui-button-text ui-c">#{msgs.newPassword_update}</span>
											<span
												class="ui-button-icon-left ui-icon ui-c ui-icon-circle-triangle-e"></span>
										</ice:commandLink></td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</center>
			<script type="text/javascript">
				//Valida nueva contrasena
				function validateNewPass() {
					var p0 = document.getElementById("form:curP1");
					var p1 = document.getElementById("form:newP1");
					var p2 = document.getElementById("form:newP2");
					var button = document.getElementById("form:changeButton");
					if (p0.value == '' || p1.value == '' || p2.value == '')
						button.style.display = 'none';
					else if (p1.value != p2.value)
						button.style.display = 'none';
					else
						button.style.display = 'block';
				}

				//Blanquea los campos
				function blankfields() {
					var p0 = document.getElementById("form:curP1");
					var p1 = document.getElementById("form:newP1");
					var p2 = document.getElementById("form:newP2");
					p0.value = '';
					p1.value = '';
					p2.value = '';
				}
				blankfields();
				validateNewPass();
			</script>
		</h:form>
	</ui:define>
</ui:composition>
</html>